{"version":2,"kind":"Notebook","sha256":"24b0b8339b9a717843819956884407a2e8783202ba5ad6a371c734486d7b2ab2","slug":"blog.2022.pint-xarray","location":"/blog/2022/pint-xarray.md","dependencies":[],"frontmatter":{"title":"Unit-aware arithmetic in Xarray, via pint","description":"All scientific computations involve units, so let's make our analysis software aware of them.\n","tags":["code","python","xarray","pint","open-science","physical-units"],"date":"2022-08-30","kernelspec":{"name":"python3","display_name":"Python 3"},"authors":[{"id":"tom","nameParsed":{"literal":"Tom Nicholas","given":"Tom","family":"Nicholas"},"name":"Tom Nicholas","orcid":"0000-0002-2176-0530","url":"https://tom-nicholas.com","github":"TomNicholas"}],"github":"https://github.com/TomNicholas/tomnicholas.github.io","abbreviations":{"LF":"The Linux Foundation","JF":"The Jupyter Foundation","JEC":"Jupyter Executive Council","JFB":"The Jupyter Foundation Board","SSC":"Software Steering Council","OSPO":"Open Source Program Office"},"numbering":{"title":{"offset":2}},"edit_url":"https://github.com/TomNicholas/tomnicholas.github.io/blob/main/blog/2022/pint-xarray.md","thumbnail":"/build/df49524368335f9010ca432f9849200d.jpeg","exports":[{"format":"md","filename":"pint-xarray.md","url":"/build/pint-xarray-9fd4759146032360193a6e66282bcfd2.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"(This post was originally published on the ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"EV0YzvVTTV"},{"type":"link","url":"https://xarray.dev/blog/introducing-pint-xarray","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"xarray blog","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"c5JGtutwpK"}],"urlSource":"https://xarray.dev/blog/introducing-pint-xarray","key":"nWDTVCKfb2"},{"type":"text","value":".)","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ad7iv69gfG"}],"key":"YQScIrortE"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"TLDR: Pint-Xarray supports unit-aware operations by wrapping ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"rUHHeJi0RJ"},{"type":"link","url":"https://pint.readthedocs.io/en/stable/","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"pint arrays","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"G2vKpggyXn"}],"urlSource":"https://pint.readthedocs.io/en/stable/","key":"WvwEHeRZdf"},{"type":"text","value":", so your code can automatically track the physical units that your data represents:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"OJ0OQtM1y0"}],"key":"R7pZkq0Jiw"}],"key":"d7HrI31Y5r"},{"type":"code","lang":"python","value":"distance = xr.DataArray(10).pint.quantify(\"metres\")\ntime = xr.DataArray(4).pint.quantify(\"seconds\")\n\ndistance / time","position":{"start":{"line":22,"column":1},"end":{"line":27,"column":1}},"key":"kgb0i3EUbt"},{"type":"code","lang":"","value":"Out:\n<xarray.DataArray ()>\n<Quantity(2.5, 'meter / second')>","position":{"start":{"line":29,"column":1},"end":{"line":33,"column":1}},"key":"cMQtWMxBSa"},{"type":"heading","depth":2,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Units are integral to science","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"oC8d3Iz3DK"}],"identifier":"units-are-integral-to-science","label":"Units are integral to science","html_id":"units-are-integral-to-science","implicit":true,"key":"UgHYMH2JB3"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"All quantities in science have units, whether explicitly or implicitly. (And even dimensionless quantities like ratios still technically have units.)","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"QJHe9g4f6l"}],"key":"NUpM91wxZP"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Getting our units right is finicky, and can very easily go unnoticed in our code.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"YW5pmlEBPi"}],"key":"yWRnzDVIiW"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Even worse, the consequences of getting units wrong can be huge!","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"T19ru4u3g1"}],"key":"rK01PAgANW"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"The most famous example of a units error has to be NASA’s $125 million ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"i7ahM8dVMc"},{"type":"link","url":"https://www.simscale.com/blog/2017/12/nasa-mars-climate-orbiter-metric/","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"Mars Climate Orbiter","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"WS8myCfZsl"}],"urlSource":"https://www.simscale.com/blog/2017/12/nasa-mars-climate-orbiter-metric/","key":"QNgKlDoDPD"},{"type":"text","value":", which in 1999 burned up in the Martian atmosphere instead of successfully entering orbit around Mars.\nA trajectory course correction had gone wrong, and the error was eventually traced back to a units mismatch: the engineers at Lockheed Martin expressed impulse in ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"biXm50z5RM"},{"type":"link","url":"https://en.wikipedia.org/wiki/Pound_(force)","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"pound-force","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"nLzge0l7VV"}],"urlSource":"https://en.wikipedia.org/wiki/Pound_(force)","data":{"page":"Pound_(force)","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"arbGauBJfv"},{"type":"text","value":" seconds, whereas the engineers at JPL assumed the impulse value their part of the software received was in SI newton seconds.","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"P6JIVSyljk"}],"key":"ND2WJUijbK"},{"type":"paragraph","children":[{"type":"image","url":"/build/df49524368335f9010ca432f9849200d.jpeg","key":"ry1sxlBe24","urlSource":"https://web.archive.org/web/20191116161743/https://clqtg10snjb14i85u49wifbv-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Customers.jpg"}],"key":"NJ5g4GbJza"},{"type":"paragraph","children":[{"type":"text","value":"Newspaper cartoon depicting the incongruence in the units used by NASA and Lockheed Martin scientists that led to the Mars Climate Orbiter disaster.","key":"pp3NzqrVHL"}],"key":"vfEzmaP6CW"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"We should take stories like this seriously: If we can automatically track units we can potentially eliminate a whole class of possible errors in our scientific work...","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"BSXkCz2Yn9"}],"key":"dJNIZP9wN4"},{"type":"heading","depth":2,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"Pint tracks units","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"M2dL6fNr7U"}],"identifier":"pint-tracks-units","label":"Pint tracks units","html_id":"pint-tracks-units","implicit":true,"key":"eTi50or0d1"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"There are a few packages for handling units in python (notably ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"cRpNHLF4DO"},{"type":"link","url":"https://github.com/yt-project/unyt","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"unyt","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"p8IKuCIDtz"}],"urlSource":"https://github.com/yt-project/unyt","error":true,"key":"dinmoVBbrv"},{"type":"text","value":" and ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"yjp5PVnqZc"},{"type":"link","url":"https://docs.astropy.org/en/stable/units/","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"astropy.units","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"fLf2X3lAvD"}],"urlSource":"https://docs.astropy.org/en/stable/units/","key":"wnsPjL2vzK"},{"type":"text","value":"), but for technical reasons we began units integration in Xarray with ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"Pf6AOqHvOT"},{"type":"link","url":"https://pint.readthedocs.io/en/stable/","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"pint","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"CbUMWStzhQ"}],"urlSource":"https://pint.readthedocs.io/en/stable/","key":"yhNhbCz3KJ"},{"type":"text","value":".\nThese various packages work by providing a numerical array type that acts similarly to a NumPy array, and is intended to plug in and replace the raw NumPy array (a so-called “duck array type”).","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"V6hpRYtv4r"}],"key":"NcyJALAE9S"},{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Pint provides the ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"eN3ushrTim"},{"type":"inlineCode","value":"Quantity","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"lTViYhT8SY"},{"type":"text","value":" object, which is a normal numpy array combined with a ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"HTvIaTTJ6l"},{"type":"inlineCode","value":"pint.Unit","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"b6EbZlIijg"},{"type":"text","value":":","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"uvtSpYbTs7"}],"key":"sc1y1ZqdMO"},{"type":"code","lang":"python","value":"q = np.array([6, 7]) * pint.Unit('metres')\nprint(repr(q))","position":{"start":{"line":64,"column":1},"end":{"line":67,"column":1}},"key":"VllTSrIR0N"},{"type":"code","lang":"","value":"Out:\n<Quantity([6 7], 'meter')>","position":{"start":{"line":69,"column":1},"end":{"line":72,"column":1}},"key":"tCcyDPL5xs"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Pint Quantities act like NumPy arrays, except that the units are carried around with the arrays, propagated through operations, and checked during operations involving multiple quantities.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"FfRaofM7m5"}],"key":"ztR0SMxTRa"},{"type":"heading","depth":2,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Xarray now wraps Pint","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"XsKjsTyy0J"}],"identifier":"xarray-now-wraps-pint","label":"Xarray now wraps Pint","html_id":"xarray-now-wraps-pint","implicit":true,"key":"xL8EcGmfVm"},{"type":"paragraph","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"Thanks to the ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"yQMyxs4buj"},{"type":"link","url":"https://github.com/pydata/xarray/issues/3594","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"tireless work","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"ePKd0ciwGx"}],"urlSource":"https://github.com/pydata/xarray/issues/3594","data":{"kind":"issue","org":"pydata","repo":"xarray","issue_number":"3594"},"internal":false,"protocol":"github","key":"QeP77mYkUW"},{"type":"text","value":" of Xarray core developer ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"lpvyClavSc"},{"type":"link","url":"https://github.com/keewis","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"Justus Magin","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"N5FHvmdzlB"}],"urlSource":"https://github.com/keewis","error":true,"key":"MgsFHtFiMV"},{"type":"text","value":", you can now enjoy this automatic unit-handling in Xarray!","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"lPW0nrNmY3"}],"key":"J0pbVbNGaF"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"Once you create a unit-aware Xarray object (see below for how) you can see the units of the data variables displayed as part of the printable representation.\nYou also immediately get the key benefits of Pint:","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"lzljp5yuzc"}],"key":"kgVe1KEP2W"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":83,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":83,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Units are propagated through arithmetic, and new quantities are built using the units of the inputs:","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"B4BWLx8UBG"}],"key":"e5xoMptl24"},{"type":"code","lang":"python","value":"distance = xr.DataArray(10).pint.quantify(\"metres\")\ntime = xr.DataArray(4).pint.quantify(\"seconds\")\n\ndistance / time","position":{"start":{"line":85,"column":1},"end":{"line":90,"column":1}},"key":"o8IMZBSJlx"},{"type":"code","lang":"","value":"Out:\n<xarray.DataArray ()>\n<Quantity(2.5, 'meter / second')>","position":{"start":{"line":92,"column":1},"end":{"line":96,"column":1}},"key":"nEdm1U4hry"}],"key":"sMbSaI9EfX"},{"type":"listItem","spread":true,"position":{"start":{"line":98,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"Dimensionally inconsistent units are caught automatically:","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"lOFvbyLdE2"}],"key":"eg3J6tK1AG"},{"type":"code","lang":"python","value":"apples = xr.DataArray(10).pint.quantify(\"kg\")\noranges = xr.DataArray(200).pint.quantify(\"cm^3\")\n\napples + oranges","position":{"start":{"line":100,"column":1},"end":{"line":105,"column":1}},"key":"S0Jr4QzCmx"},{"type":"code","lang":"","value":"Out:\nDimensionalityError: Cannot convert from 'kilogram' ([mass]) to 'centimeter ** 3' ([length] ** 3)","position":{"start":{"line":107,"column":1},"end":{"line":110,"column":1}},"key":"v4XQzm4YHD"}],"key":"gIXdpWzGM4"},{"type":"listItem","spread":true,"position":{"start":{"line":112,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"Unit conversions become simple:","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"N03VAgqNFy"}],"key":"DC67yYYD9D"},{"type":"code","lang":"python","value":"walk = xr.DataArray(500).pint.quantify('miles')\n\nwalk.pint.to('parsecs')","position":{"start":{"line":114,"column":1},"end":{"line":118,"column":1}},"key":"aOnv1ShqeJ"},{"type":"code","lang":"","value":"Out:\n<xarray.DataArray ()>\n<Quantity(2.6077643524162074e-11, 'parsec')>","position":{"start":{"line":120,"column":1},"end":{"line":124,"column":1}},"key":"c3Gvhf96Ks"}],"key":"lbyhqg5CPO"}],"key":"aYagWQzBs4"},{"type":"paragraph","position":{"start":{"line":126,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"With these features, you can build code that automatically propagates units and converts them where necessary to stay consistent.\nFor example, the problem of the NASA orbiter could have been prevented by explicitly converting to the correct units at the start","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"a9eFAnqyc3"}],"key":"aL0asljLnx"},{"type":"code","lang":"python","value":"def jpl_trajectory_code(impulse):\n\n    # Defensively check units first\n    impulse = impulse.pint.to(\"Newton * seconds\")\n\n    # This function we called here will only compute the correct result if supplied input in units of Newton-seconds,\n    # but that's fine because we already converted the values to be in the correct units!\n    propagated_position = some_rocket_science(impulse)\n\n    return propagated_position","position":{"start":{"line":129,"column":1},"end":{"line":140,"column":1}},"key":"jhCQTQ2qBw"},{"type":"paragraph","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"text","value":"Note: We are adding ","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"zUN2W1glqD"},{"type":"link","url":"https://github.com/xarray-contrib/pint-xarray/pull/143","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"text","value":"new features","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"bqguuxPGYw"}],"urlSource":"https://github.com/xarray-contrib/pint-xarray/pull/143","data":{"kind":"issue","org":"xarray-contrib","repo":"pint-xarray","issue_number":"143"},"internal":false,"protocol":"github","key":"TkerRrnHMQ"},{"type":"text","value":" to make specifying the units of parameters of existing library functions more slick.","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"wmuSrLWl0a"}],"key":"RQx39QvnQG"},{"type":"paragraph","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"text","value":"In the abstract, tracking units like this is useful in the same way that labelling dimensions with Xarray is useful: it helps us avoid errors by relieving us of the burden of remembering arbitrary information about our data.","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"xg0gUdJobR"}],"key":"YhOqvJdJw5"},{"type":"heading","depth":2,"position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"Quantifying with pint-xarray","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"ZlU3TOPuHw"}],"identifier":"quantifying-with-pint-xarray","label":"Quantifying with pint-xarray","html_id":"quantifying-with-pint-xarray","implicit":true,"key":"YMonL0Awdz"},{"type":"paragraph","position":{"start":{"line":148,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"The easiest way to create a unit-aware Xarray object is to use the helper package we made: ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"dEEM9mE3iI"},{"type":"link","url":"https://github.com/xarray-contrib/pint-xarray","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"pint-xarray","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"eU35tKUqgg"}],"urlSource":"https://github.com/xarray-contrib/pint-xarray","error":true,"key":"NyzoNLyhJg"},{"type":"text","value":".\nOnce you ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"VT07oSnXAH"},{"type":"inlineCode","value":"import pint_xarray","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"XYUOlSUaBJ"},{"type":"text","value":" you can access unit-related functionality via ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"KykGjkQBvq"},{"type":"inlineCode","value":".pint","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"tyEr2ZxJKk"},{"type":"text","value":" on any ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"OLmj5605w6"},{"type":"inlineCode","value":"DataArray","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"PPn3wrtqxB"},{"type":"text","value":" or ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"ZS8J0P4Nk4"},{"type":"inlineCode","value":"Dataset","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"cYL0Y4V2nE"},{"type":"text","value":" (this works via ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"YIPFMTjCGu"},{"type":"link","url":"https://xarray.pydata.org/en/stable/internals/extending-xarray.html","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"Xarray’s accessor interface","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"QJCoK50xVU"}],"urlSource":"https://xarray.pydata.org/en/stable/internals/extending-xarray.html","key":"Pzljnrrfm9"},{"type":"text","value":").","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"dUU3293CFp"}],"key":"LBeR8Cuzl1"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"Above we have seen examples of quantifying explicitly, where we specify the units in the call to ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"rVZba6jxob"},{"type":"inlineCode","value":".quantify()","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"tQyT2CM5QP"},{"type":"text","value":".\nWe can do this for multiple variables too, and we can also pass ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"fkRr3vMhGV"},{"type":"inlineCode","value":"pint.Unit","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"cbbf5SsQbl"},{"type":"text","value":" instances:","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"LxWG5PSWtQ"}],"key":"oKLbkIZc19"},{"type":"code","lang":"python","value":"ds = xr.Dataset({'a': 2, 'b': 10})\n\nds.pint.quantify({'a': 'kg',\n                  'b': pint.Unit('moles')})","position":{"start":{"line":154,"column":1},"end":{"line":159,"column":1}},"key":"oc1u02B7tL"},{"type":"code","lang":"","value":"Out:\n<xarray.Dataset>\nDimensions:  ()\nData variables:\n    a        int64 [kg] 2\n    b        int64 [mol] 10","position":{"start":{"line":161,"column":1},"end":{"line":168,"column":1}},"key":"eDphHfhkLD"},{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"text","value":"Alternatively, we can quantify from the object’s ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"dRJzPVAYcy"},{"type":"inlineCode","value":".attrs","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"yTKom6CSFO"},{"type":"text","value":", automatically reading the metadata which xarray objects carry around.\nIf nothing is passed to ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"wZt9XKMMf2"},{"type":"inlineCode","value":".quantify()","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"zFU5sAk5ua"},{"type":"text","value":", it will attempt to parse the ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"Ak1nPuCAqs"},{"type":"inlineCode","value":".attrs['units']","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"j18KBWMT7y"},{"type":"text","value":" entry for each data variable.","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"P09K7jNMgc"}],"key":"RH9mZZNYBZ"},{"type":"paragraph","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"This means that for scientific datasets which are stored as files with units in their attributes (which netCDF and Zarr can do for example), using Pint with Xarray becomes as simple as:","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"vsZkmGHYT9"}],"key":"OcqJh2Kse8"},{"type":"code","lang":"python","value":"import pint_xarray\n\nds = open_dataset(filepath).pint.quantify()","position":{"start":{"line":175,"column":1},"end":{"line":179,"column":1}},"key":"nC6OgxllOk"},{"type":"heading","depth":2,"position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"Dequantifying","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"TNKqRpI2jy"}],"identifier":"dequantifying","label":"Dequantifying","html_id":"dequantifying","implicit":true,"key":"SALXPNIRiF"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"To convert our pint arrays back into NumPy arrays, we can use ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"CcO8oY3uX1"},{"type":"inlineCode","value":".dequantify","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"BaQgoUvVIV"},{"type":"text","value":".\nThis will strip the units from the arrays and replace them into the ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"thHmpZfxFg"},{"type":"inlineCode","value":".attrs['units']","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"FAUDlLYOSx"},{"type":"text","value":" of each variable.\nThis is useful when we want to save our data back to a file, as it means that the current units will be preserved in the attributes of a netCDF file (or Zarr store etc.), as long as we just do ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"FmkPr7if6l"},{"type":"inlineCode","value":"ds.pint.dequantify().to_netcdf(...)","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"BVlXi1nvu1"},{"type":"text","value":".","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"rRrHlLZatC"}],"key":"TkHy1OUWcJ"},{"type":"heading","depth":2,"position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Dask integration","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"QeahiLHjqD"}],"identifier":"dask-integration","label":"Dask integration","html_id":"dask-integration","implicit":true,"key":"OvZh3hq1uW"},{"type":"paragraph","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"So Xarray can wrap Dask arrays, and now it can wrap Pint quantities… Can we use both together? Yes!","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"FAXtoAZNgw"}],"key":"CNiD10OPLG"},{"type":"paragraph","position":{"start":{"line":191,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"You can get a unit-aware, Dask-backed array either by ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"CcdEaLUqQY"},{"type":"inlineCode","value":".pint.quantify()","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"DYwCbIYEu3"},{"type":"text","value":"-ing a chunked array, or you can ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"JuwDFsyHHJ"},{"type":"inlineCode","value":".pint.chunk()","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"LnET9oyrXZ"},{"type":"text","value":" a quantified array.\n(If you have Dask installed, then ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"VFzoMDaTvE"},{"type":"inlineCode","value":"open_dataset(f, chunks={}).pint.quantify()","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"liDumIEtvt"},{"type":"text","value":" will already give you a Dask-backed, quantified array.)\nFrom there you can ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"mSnJ24uGKx"},{"type":"inlineCode","value":".compute()","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"HFrraQEhiz"},{"type":"text","value":" the Dask-backed objects as normal, and the units will be retained.","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"p1T3y3pMht"}],"key":"WeKiq4iIUi"},{"type":"paragraph","position":{"start":{"line":195,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"(Under the hood we now have an ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"QqqWXeaHAp"},{"type":"inlineCode","value":"xarray.DataArray","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"Fgofde1DTz"},{"type":"text","value":" wrapping a ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"ejKeRzK0r2"},{"type":"inlineCode","value":"pint.Quantity","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"s4V26ItKpy"},{"type":"text","value":", which wraps a ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"tBZQTtkIPN"},{"type":"inlineCode","value":"dask.array.Array","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"w32PXr3QQ6"},{"type":"text","value":", which wraps a ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"hBhMugPvhI"},{"type":"inlineCode","value":"numpy.ndarray","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"bkOIdLU1df"},{"type":"text","value":".\nThis “multi-nested duck array” approach can be generalised to include other array libraries (e.g. ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"yrubtA4U8y"},{"type":"inlineCode","value":"scipy.sparse","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"FaEONbkwBK"},{"type":"text","value":"), but requires ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"gWWaVuC6ZA"},{"type":"link","url":"https://github.com/pydata/duck-array-discussion","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"coordination","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"N53JeqCR5i"}],"urlSource":"https://github.com/pydata/duck-array-discussion","error":true,"key":"YfRbC5M4OL"},{"type":"text","value":" between the maintainers of the libraries involved.)","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"qYdwZRavWt"}],"key":"gyPB3fG3q5"},{"type":"heading","depth":2,"position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"Unit-aware indexes","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"ciS8YAfbBr"}],"identifier":"unit-aware-indexes","label":"Unit-aware indexes","html_id":"unit-aware-indexes","implicit":true,"key":"zlq9bpbo5o"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"We would love to be able to promote Xarray indexes to Pint Quantities, as that would allow you to select data subsets in a unit-aware manner like:","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"mSORBEdHrd"}],"key":"NKjCTmCRC8"},{"type":"code","lang":"python","value":"da = xr.DataArray(name='a', data=[0, 1, 2], dims='x', coords={'x': [1000, 2000, 3000]})\nda = da.pint.quantify({'a': 'Pa', 'x': 'm'})\n\nda.pint.sel(x=2 * 'km')","position":{"start":{"line":202,"column":1},"end":{"line":207,"column":1}},"key":"dhLy1lDhzs"},{"type":"paragraph","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"text","value":"Unfortunately this will not possible until the ongoing work to extend Xarray to support ","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"WWq1nfKlVF"},{"type":"link","url":"https://github.com/pydata/xarray/issues/1603","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"text","value":"explicit indexes","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"AcOBW6Gelh"}],"urlSource":"https://github.com/pydata/xarray/issues/1603","data":{"kind":"issue","org":"pydata","repo":"xarray","issue_number":"1603"},"internal":false,"protocol":"github","key":"w5TEDB0LU1"},{"type":"text","value":" is complete.","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"rf5LXbC8Qz"}],"key":"Bl0FdmjZzu"},{"type":"paragraph","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"text","value":"In the meantime pint-xarray offers a workaround. If you tell ","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"R6AZNWXvQk"},{"type":"inlineCode","value":".quantify","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"W8fiQCR9Bi"},{"type":"text","value":" the units you wish an index to have, it will store those in ","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"ed1EkNSmVF"},{"type":"inlineCode","value":".attrs[\"units\"]","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"USpjLHsNSF"},{"type":"text","value":" instead.","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"w1OybL4YPh"}],"key":"WxknDBev6M"},{"type":"code","lang":"python","value":"time = xr.DataArray([0.1, 0.2, 0.3], dims='time')\ndistance = xr.DataArray(name='distance',\n                        data=[10, 20, 25],\n                        dims=['time'],\n                        coords={'time': time})\ndistance = distance.pint.quantify({'distance': 'metres',\n                                   'time': 'seconds'})\nprint(distance.coords['time'].attrs)","position":{"start":{"line":213,"column":1},"end":{"line":222,"column":1}},"key":"KXgHCX6kMx"},{"type":"code","lang":"","value":"Out:\n{'units': <Unit('second')>}","position":{"start":{"line":224,"column":1},"end":{"line":227,"column":1}},"key":"XZ8tEkEwxb"},{"type":"paragraph","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"text","value":"This allows us to provide conveniently wrapped versions of common xarray methods like ","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"RObNPWkC9R"},{"type":"inlineCode","value":".sel","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"rwl8z6zJj6"},{"type":"text","value":", so that you can still select subsets of data in a unit-aware fashion like this:","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"a7lV62NEzX"}],"key":"UuBEch4U4e"},{"type":"code","lang":"python","value":"distance.pint.sel(time=200 * pint.Unit('milliseconds'))","position":{"start":{"line":231,"column":1},"end":{"line":233,"column":1}},"key":"qWxdrxWnlr"},{"type":"code","lang":"","value":"Out:\n<xarray.DataArray 'distance' ()>\n<Quantity(20, 'meter')>\nCoordinates:\n    time     float64 200.0","position":{"start":{"line":235,"column":1},"end":{"line":241,"column":1}},"key":"Ut7736IBA0"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"Observe how the ","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"h5g08O6kxa"},{"type":"inlineCode","value":".pint.sel","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"Cgw2mhV20q"},{"type":"text","value":" operation has first converted 200 milliseconds to 0.2 seconds, before finding the distance value that occurs at a time position of 0.2 seconds.","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"h26QiWvxN2"}],"key":"zlDusa5njg"},{"type":"paragraph","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"children":[{"type":"link","url":"https://xarray.pydata.org/en/stable/user-guide/duckarrays.html#missing-features","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"children":[{"type":"text","value":"This wrapping is currently necessary","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"DOUoqkaAt9"}],"urlSource":"https://xarray.pydata.org/en/stable/user-guide/duckarrays.html#missing-features","key":"m4yR0if3EE"},{"type":"text","value":" for any operation which needs to be aware of the units of a dimension coordinate of the dataarray, or any xarray operation which relies on an external library (such as calling ","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"Fv4YZ17olo"},{"type":"inlineCode","value":"scipy","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"d5nvBlAskP"},{"type":"text","value":" in ","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"k7O4EItJ3N"},{"type":"inlineCode","value":".integrate","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"vSzs7GegK6"},{"type":"text","value":").","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"DDvWhU1oL0"}],"key":"L2uDuZfc7Q"},{"type":"heading","depth":2,"position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"CF-compliant units for geosciences with cf-xarray","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"FBvj6DfIGZ"}],"identifier":"cf-compliant-units-for-geosciences-with-cf-xarray","label":"CF-compliant units for geosciences with cf-xarray","html_id":"cf-compliant-units-for-geosciences-with-cf-xarray","implicit":true,"key":"ZADlnvfqQ3"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"Different fields tend to have different niche conventions about how certain units are defined.\nBy default, Pint doesn’t understand all the unusual units and conventions we use in geosciences.\nBut ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"hp1P97uGzm"},{"type":"link","url":"https://pint.readthedocs.io/en/stable/defining.html","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"Pint is customisable","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"rTy1PVBIdg"}],"urlSource":"https://pint.readthedocs.io/en/stable/defining.html","key":"WiOQ2LtUVY"},{"type":"text","value":", and with the help of ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"IjLkoB8Ah8"},{"type":"link","url":"https://github.com/xarray-contrib/cf-xarray","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"cf-xarray","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"vIjssYOjly"}],"urlSource":"https://github.com/xarray-contrib/cf-xarray","error":true,"key":"uJAmeRwB78"},{"type":"text","value":" we can teach it about these geoscience-specific units.","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"Z2hTqh4eyG"}],"key":"UBYF9V9Bi5"},{"type":"paragraph","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"If we ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"Fi0l0EbUJp"},{"type":"inlineCode","value":"import cf_xarray.units","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"nFGcXkj8BQ"},{"type":"text","value":" (before ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"YTJhpcf7Xe"},{"type":"inlineCode","value":"import pint_xarray","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"CsjlVvu0qd"},{"type":"text","value":") then we can ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"SSWCB7bB7e"},{"type":"inlineCode","value":"quantify","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"oKaF6YEKf9"},{"type":"text","value":" example climate data from the ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"iDzeHuSyVg"},{"type":"link","url":"https://pangeo-data.github.io/pangeo-cmip6-cloud/","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"Pangeo Project’s CMIP6 catalog","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"A35XLVFexP"}],"urlSource":"https://pangeo-data.github.io/pangeo-cmip6-cloud/","key":"V16K3fuT2H"},{"type":"text","value":":","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"aYcc9PzOXU"}],"key":"pv2Nbw1Wnn"},{"type":"code","lang":"python","value":"import xarray as xr\nimport cf_xarray.units\nimport pint_xarray\n\nds = xr.open_dataset('gs://cmip6/CMIP6/CMIP/NCAR/CESM2-FV2/historical/r2i1p1f1/Amon/sfcWind/gn/v20200226/', engine='zarr')\nds = ds.pint.quantify()\n\nsquared_wind = ds['sfcWind'] ** 2\nsquared_wind.pint.units","position":{"start":{"line":255,"column":1},"end":{"line":265,"column":1}},"key":"HFMAeZ81RK"},{"type":"code","lang":"","value":"Out:\n<Unit('meter ** 2 / second ** 2')>","position":{"start":{"line":267,"column":1},"end":{"line":270,"column":1}},"key":"n0qp6q3YK2"},{"type":"paragraph","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"Here (thanks to ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"NDts7s9WUW"},{"type":"inlineCode","value":"cf_xarray","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"RsE3rvsRpG"},{"type":"text","value":") pint has successfully interpreted the CF-style units ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"yX9T23tsQ8"},{"type":"inlineCode","value":"'m s-1'","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"N53yDC5JuW"},{"type":"text","value":", then automatically changed them when we squared the wind speed.","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"DKD9w2ZD4B"}],"key":"DxAJdYQKow"},{"type":"heading","depth":2,"position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"Plotting","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"qVCl9ntuex"}],"identifier":"plotting","label":"Plotting","html_id":"plotting","implicit":true,"key":"QEuUMP5xij"},{"type":"paragraph","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"We can complete our real-world example by plotting the data in its new units:","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"IdU5bnI035"}],"key":"M563E6FWBP"},{"type":"code","lang":"python","value":"import cartopy.crs as ccrs\nimport matplotlib.pyplot as plt\n\np = squared_wind.isel(time=\"2014-01\").plot(\n    subplot_kws=dict(projection=ccrs.Orthographic(-80, 35), facecolor=\"gray\"),\n    transform=ccrs.PlateCarree(),\n)\np.axes.set_global()\np.axes.coastlines()\nplt.show()","position":{"start":{"line":278,"column":1},"end":{"line":289,"column":1}},"key":"JqQHvGjVDz"},{"type":"image","url":"/build/squared_wind-c4b03a19e4f673d8ac48dc40b8f70016.png","alt":"cartopy plot of a quantified dataset","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"key":"MfDkY2qGZo","urlSource":"/images/squared_wind.png"},{"type":"paragraph","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"Up268oeQnn"},{"type":"inlineCode","value":"xarray.plot","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"bjdqErzBRp"},{"type":"text","value":" has detected the Pint units automatically.","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"YGKw1mhfWR"}],"key":"CFgOwsDeZ8"},{"type":"heading","depth":2,"position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"Conclusion","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"Vdz4TJe21y"}],"identifier":"conclusion","label":"Conclusion","html_id":"conclusion","implicit":true,"key":"SCdhAgsUNA"},{"type":"paragraph","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"Please have a go! You will need xarray (v2022.03.0+), pint (0.18+), and pint-xarray (0.3+).","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"jzxfWz18H6"}],"key":"BWUNLYpm2A"},{"type":"paragraph","position":{"start":{"line":299,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"Please also tell us about any bugs you find, or documentation suggestions you have on the ","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"bSAhzALcNA"},{"type":"link","url":"https://github.com/pydata/xarray/issues","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"children":[{"type":"text","value":"Xarray","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"nNmI4fhYC8"}],"urlSource":"https://github.com/pydata/xarray/issues","error":true,"key":"ahRDdlzVJ0"},{"type":"text","value":" or ","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"IrWgbfqfeF"},{"type":"link","url":"https://github.com/xarray-contrib/pint-xarray/issues","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"children":[{"type":"text","value":"pint-xarray issue trackers","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"E7ZM8GS6my"}],"urlSource":"https://github.com/xarray-contrib/pint-xarray/issues","error":true,"key":"uOJa0zG7M1"},{"type":"text","value":".\nIf you have usage questions you can raise them there, on the ","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"YomJMRwha0"},{"type":"link","url":"https://github.com/pydata/xarray/discussions","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"children":[{"type":"text","value":"Xarray discussions page","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"dBjiZu1eqA"}],"urlSource":"https://github.com/pydata/xarray/discussions","error":true,"key":"jdYK4OPK2X"},{"type":"text","value":", or on the ","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"TyAA1fkOoK"},{"type":"link","url":"https://discourse.pangeo.io/","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"children":[{"type":"text","value":"Pangeo Discourse forum","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"HvqsoA2GiV"}],"urlSource":"https://discourse.pangeo.io/","key":"ZOeSXSaYaf"},{"type":"text","value":".","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"Bg3f6sYiRg"}],"key":"Fcfl2yzcg4"},{"type":"paragraph","position":{"start":{"line":302,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"text","value":"The work here to allow Xarray to wrap Pint objects is part of a ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"pZSa1IKsko"},{"type":"link","url":"http://xarray.pydata.org/en/stable/roadmap.html#flexible-arrays","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"broader effort to generalise Xarray","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"t03rk5xvm4"}],"urlSource":"http://xarray.pydata.org/en/stable/roadmap.html#flexible-arrays","key":"rRO3xlaWmN"},{"type":"text","value":" to handle a wide variety of data types (so-called “duck array wrapping”).\nAlong with the incoming ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"y7zu1LpIjP"},{"type":"link","url":"http://xarray.pydata.org/en/stable/roadmap.html#flexible-indexes","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"support for flexible indexes","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"oODLX6EgP6"}],"urlSource":"http://xarray.pydata.org/en/stable/roadmap.html#flexible-indexes","key":"RAbwdskJZA"},{"type":"text","value":", we are excited for all the new features that this will enable for Xarray users!","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"BVAgE0CaQB"}],"key":"OMJ5tnGA2s"}],"key":"ofvRPP4BUO"}],"key":"iUapSD7lU4"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Easy IPCC part 1: Multi-Model Datatree","url":"/blog/2022/easy-ipcc-datatree","group":"2022"},"next":{"title":"Coronavirus: The Simplest Model","url":"/blog/2020/covid19-model","group":"2021"}}},"domain":"http://localhost:3000"}